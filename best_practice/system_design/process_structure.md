# プロセス設計

■ サービスマネジャーでプロセスを管理する

- web アプリケーションサーバー: web アプリケーションを実行するサーバープロセス。
- Django の manage.py runserver もサーバー機能を提供するが、簡易的な機能で本番には不向き。例えば、runserver には並列機能がないため、ブラウザからの複数のリクエストを同時に処理できない。死活監視機能もなく、プロセスか何かの問題で停止したら人間が気づいて直す必要がある。
- 本番環境やそれに近い環境で Django を常駐実行する場合、サービスマネジャーと web アプリケーションサーバーを使用する。
  - サービスマネジャー：常駐するデーモンプロセスの起動や終了を管理し、以上終了時の自動再起動などを行う。最近の Linux では Systemd が標準的に利用されている。
  - web アプリケーションサーバー：Gunicorn や uWSGI などが利用されている、本番環境想定の web アプリケーションサーバーは複数プロセス起動による並列処理機能と死活監視を提供している。

■ デーモンは自動で起動させる

- デーモン：UNIX 系 OS のメインメモリ上に常駐して特定の機能を提供するプログラム。利用者の操作とは無関係に処理を行う。別のプログラムや機器、通信相手など外部からの要求を受け付けて処理を実行したり、あらかじめ設定されたタイミングで自律的に特定の処理を実行したりする。

サーバー上で、systemd を使ってデーモン化したら systemctl で自動起動の設定をしておく。  
サーバー再起動後に自動起動の設定が外れているので、設定を確認する必要がある。

```
sudo systemctl start gunicorn-djangoapp
systemctl is-enabled gunicorn-djangoapp
systemctl enable gunicorn-djangoapp
'''
```
