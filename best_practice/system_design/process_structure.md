# プロセス設計

■サービスマネジャーでプロセスを管理する

- webアプリケーションサーバー: webアプリケーションを実行するサーバープロセス。
- Djangoのmanage.py runserverもサーバー機能を提供するが、簡易的な機能で本番には不向き。  
&nbsp;例えば、runserverには並列機能がないため、ブラウザからの複数のリクエストを同時に処理できない。  
&nbsp;死活監視機能もなく、プロセスか何かの問題で停止したら人間が気づいて直す必要がある。  
- 本番環境やそれに近い環境でDjangoを常駐実行する場合、サービスマネジャーとwebアプリケーションサーバーを使用する。
    - サービスマネジャー：常駐するデーモンプロセスの起動や終了を管理し、以上終了時の自動再起動などを行う。  
    &nbsp;&nbsp;最近のLinuxではSystemdが標準的に利用されている。
    - webアプリケーションサーバー：GunicornやuWSGIなどが利用されている、  
    &nbsp;&nbsp;本番環境想定のwebアプリケーションサーバーは複数プロセス起動による並列処理機能と死活監視を提供している。

■デーモンは自動で起動させる

- デーモン：UNIX系OSのメインメモリ上に常駐して特定の機能を提供するプログラム。利用者の操作とは無関係に処理を行う。  
&nbsp;&nbsp;別のプログラムや機器、通信相手など外部からの要求を受け付けて処理を実行したり、あらかじめ設定されたタイミングで自律的に特定の処理を実行したりする。


サーバー上で、systemdを使ってデーモン化したらsystemctlで自動起動の設定をしておく。  
サーバー再起動後に自動起動の設定が外れているので、設定を確認する必要がある。
```
sudo systemctl start gunicorn-djangoapp
systemctl is-enabled gunicorn-djangoapp
systemctl enable gunicorn-djangoapp
'''